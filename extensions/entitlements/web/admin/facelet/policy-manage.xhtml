<?xml version='1.0' encoding='UTF-8'?>
<ui:composition
    template="template/page.xhtml"
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:ice="http://www.icesoft.com/icefaces/component"
    xmlns:o="http://opensso.dev.java.net">
    <ui:define name="panel-title">
        <ice:outputText value="#{msg.policyManagePanelTitle}" />
    </ui:define>
    <ui:define name="panel-details">
        <ice:outputText value="#{msg.policyManagePanelDetails}" />
    </ui:define>
    <ui:define name="panel-body">
        <div class="section-outer">
            <o:box>
                <ui:define name="body">
                    <div class="section-inner">
                        <ice:dataTable
                            id="policyManageTable"
                            var="privilegeBean"
                            value="#{policyManageHandler.policyManageBean.privilegeBeans}"
                            sortColumn="#{policyManageBean.policyManageTableBean.sortKey.column}"
                            sortAscending="#{policyManageBean.policyManageTableBean.sortKey.ascending}">
                            <ice:column>
                                <f:facet name="header">
                                    <ice:commandSortHeader
                                        columnName="name"
                                        actionListener="#{policyManageHandler.sortTableListener}">
                                        <ice:outputText
                                            value="Name"/>
                                    </ice:commandSortHeader>
                                </f:facet>
                                <ice:outputText
                                    value="#{privilegeBean.name}"/>
                            </ice:column>
                            <ice:column>
                                <f:facet name="header">
                                    <ice:outputText
                                        value="Resources"/>
                                </f:facet>
                                <ice:panelGroup
                                    panelTooltip="resourcesTooltip">
                                    <ice:outputText
                                        value="#{o:truncate(privilegeBean.viewEntitlement.resourcesToString, policyManageBean.policyManageTableBean.cellWidth)}"/>
                                </ice:panelGroup>
                                <o:tooltip
                                    tooltipId="resourcesTooltip"
                                    title="#{privilegeBean.name}: resources (#{o:size(privilegeBean.viewEntitlement.resources)})">
                                    <ui:define name="body">
                                        <pre>
                                        <ice:outputText
                                            value="#{privilegeBean.viewEntitlement.resourcesToFormattedString}"/>
                                        </pre>
                                    </ui:define>
                                </o:tooltip>
                            </ice:column>
                            <ice:column>
                                <f:facet name="header">
                                    <ice:outputText
                                        value="Subjects"/>
                                </f:facet>
                                <ice:panelGroup
                                    panelTooltip="subjectTooltip">
                                    <ice:outputText
                                        value="#{o:truncate(privilegeBean.viewSubject.toString, policyManageBean.policyManageTableBean.cellWidth)}"/>
                                </ice:panelGroup>
                                <o:tooltip
                                    tooltipId="subjectTooltip"
                                    title="#{privilegeBean.name}: subjects (#{privilegeBean.viewSubject.size})">
                                    <ui:define name="body">
                                        <pre>
                                        <ice:outputText
                                            value="#{privilegeBean.viewSubject.toFormattedString}"/>
                                        </pre>
                                    </ui:define>
                                </o:tooltip>
                            </ice:column>
                            <ice:column>
                                <f:facet name="header">
                                    <ice:outputText
                                        value="Conditions"/>
                                </f:facet>
                                <ice:panelGroup
                                    panelTooltip="conditionTooltip">
                                    <ice:outputText
                                        value="#{o:truncate(privilegeBean.viewCondition.toString, policyManageBean.policyManageTableBean.cellWidth)}"/>
                                </ice:panelGroup>
                                <o:tooltip
                                    tooltipId="conditionTooltip"
                                    title="#{privilegeBean.name}: conditions (#{privilegeBean.viewCondition.size})">
                                    <ui:define name="body">
                                        <pre>
                                        <ice:outputText
                                            value="#{privilegeBean.viewCondition.toFormattedString}"/>
                                        </pre>
                                    </ui:define>
                                </o:tooltip>
                            </ice:column>
                        </ice:dataTable>
                    </div>
                </ui:define>
            </o:box>
        </div>
    </ui:define>
</ui:composition>
