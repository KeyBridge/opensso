<?xml version='1.0' encoding='UTF-8'?>
<ui:composition
    template="template/page.xhtml"
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:ice="http://www.icesoft.com/icefaces/component"
    xmlns:o="http://opensso.dev.java.net">

    <ui:define name="panel-title">
        <ice:outputText value="#{msg.policyEditPanelTitle}" />
    </ui:define>
    <ui:define name="panel-details">
        <ice:outputText value="#{msg.policyEditPanelDetails}" />
    </ui:define>
    <ui:define name="panel-body">
        <ui:include
            src="/admin/facelet/template/policy-edit-cancel-popup.xhtml">
            <ui:param
                name="policyWizardBean"
                value="#{policyEditWizardBean}"/>
            <ui:param
                name="policyWizardHandler"
                value="#{policyEditWizardHandler}"/>
        </ui:include>
        <ui:include
            src="/admin/facelet/template/policy-edit-finish-popup.xhtml">
            <ui:param
                name="policyWizardBean"
                value="#{policyEditWizardBean}"/>
            <ui:param
                name="policyWizardHandler"
                value="#{policyEditWizardHandler}"/>
        </ui:include>
        <o:wizard
            steps="5"
            wizardHandler="#{policyEditWizardHandler}"
            wizardBean="#{policyEditWizardBean}">
            <ui:define name="wizard-steps">
                <o:wstep
                    step="0"
                    label="Name, Description, and Application">
                    <ui:define name="wizard-step-body">
                        <ui:include src="template/policy-name.xhtml">
                            <ui:param
                                name="policyNameBean"
                                value="#{policyEditWizardBean}"/>
                            <ui:param
                                name="policyNameHandler"
                                value="#{policyEditWizardHandler}"/>
                        </ui:include>
                    </ui:define>
                </o:wstep>
                <o:wstep
                    step="1"
                    label="Resources (#{o:size(policyEditWizardBean.privilegeBean.viewEntitlement.resources)})">
                    <ui:define name="wizard-step-body">
                        <ui:include
                            src="#{policyEditWizardBean.viewApplication.viewApplicationType.resourceTemplate}">
                            <ui:param
                                name="policyResourcesBean"
                                value="#{policyEditWizardBean}"/>
                        </ui:include>
                    </ui:define>
                </o:wstep>
                <o:wstep
                    step="2"
                    label="Subjects (#{policyEditWizardBean.privilegeBean.viewSubject != null ? policyEditWizardBean.privilegeBean.viewSubject.size : 0})">
                    <ui:define name="wizard-step-body">
                        <ui:include src="template/policy-subjects.xhtml">
                            <ui:param
                                name="policySubjectsBean"
                                value="#{policyEditWizardBean}"/>
                            <ui:param
                                name="policySubjectsHandler"
                                value="#{policyEditWizardHandler}"/>
                        </ui:include>
                    </ui:define>
                </o:wstep>
                <o:wstep
                    step="3"
                    label="Advanced">
                    <ui:define name="wizard-step-body">
                        <ui:include src="template/policy-create-advanced.xhtml">
                            <ui:param
                                name="policyWizardBean"
                                value="#{policyEditWizardBean}"/>
                            <ui:param
                                name="policyWizardHandler"
                                value="#{policyEditWizardHandler}"/>
                        </ui:include>
                    </ui:define>
                </o:wstep>
                <o:wstep
                    step="4"
                    label="Summary">
                    <ui:define name="wizard-step-body">
                        <ui:include src="template/policy-summary.xhtml">
                            <ui:param
                                name="policySummaryBean"
                                value="#{policyEditWizardBean}"/>
                            <ui:param
                                name="policySummaryHandler"
                                value="#{policyEditWizardHandler}"/>
                        </ui:include>
                    </ui:define>
                </o:wstep>
            </ui:define>
        </o:wizard>
    </ui:define>
</ui:composition>
