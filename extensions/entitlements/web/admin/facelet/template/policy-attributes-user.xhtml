<?xml version='1.0' encoding='UTF-8'?>
<span
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:ice="http://www.icesoft.com/icefaces/component"
    xmlns:c="http://java.sun.com/jstl/core"
    xmlns:o="http://opensso.dev.java.net">

    <ice:panelSeries
        var="attributesBean"
        value="#{attributesBeans}">
        <ice:panelGroup
            rendered="#{attributesBean.attributeType.toString == 'USER'}">
            <div class="section-outer">
                <o:box>
                    <ui:define name="body">
                        <div class="section-inner">
                            <span class="section-head">
                                <span class="section-title">
                                    <ice:outputText value="User Attributes"/>
                                </span>
                            </span>
                            <div class="section-details">
                                <ice:outputText
                                    value="#{resources['policy-attributes-user.sectionDetails']}"/>
                            </div>
                            <div class="clear"></div>
                            <ice:panelGrid
                                styleClass="user-attributes"
                                columnClasses="user-attributes-selected,user-attributes-gutter,user-attributes-available"
                                columns="3">
                                <ice:panelGroup
                                    dropTarget="true"
                                    dropListener="#{attributesBean.attributesHandler.dropListener}">
                                    <ice:dataTable
                                        visible="#{o:size(attributesBean.viewAttributes) > 0}"
                                        columnClasses="attributesCol1,attributesCol3"
                                        value="#{attributesBean.viewAttributes}"
                                        var="attribute">
                                        <ice:column>
                                            <f:facet name="header">
                                                <ice:outputText value="Name"/>
                                            </f:facet>
                                            <ice:panelGroup>
                                                <ice:outputText
                                                    value="#{attribute.title}"/>
                                            </ice:panelGroup>
                                        </ice:column>
                                        <ice:column>
                                            <f:facet name="header">
                                                <ice:outputText value="Remove"/>
                                            </f:facet>
                                            <ice:panelGroup>
                                                <ice:commandLink
                                                    actionListener="#{attributesBean.attributesHandler.removeListener}">
                                                    <f:attribute
                                                        name="viewAttribute"
                                                        value="#{attribute}"/>
                                                    <ice:graphicImage
                                                        value="../image/remove-16.png"/>
                                                </ice:commandLink>
                                            </ice:panelGroup>
                                        </ice:column>
                                    </ice:dataTable>
                                    <ice:panelGroup
                                        styleClass="drop-target">
                                        <ice:outputText
                                            value="Drag user attribute keys here ..."/>
                                    </ice:panelGroup>
                                </ice:panelGroup>
                                <ice:panelGroup/>
                                <ice:panelGroup>
                                    <o:multipanel
                                        visible="true"
                                        expanded="#{userAttributesPanelBean.expanded}"
                                        bean="#{userAttributesPanelBean}"
                                        handler="#{basicMultiPanelHandler}"
                                        collapsible="true"
                                        removeable="false">
                                        <ui:define name="panel-title">
                                            <ice:panelGroup>
                                                <ice:outputText value="User Attributes"/>
                                            </ice:panelGroup>
                                        </ui:define>
                                        <ui:define name="panel-body">
                                            <ice:panelGrid
                                                columns="2">
                                                <ice:graphicImage
                                                    value="../image/search.png"/>
                                                <ice:inputText
                                                    value="#{attributesBean.filter}"
                                                    onkeyup="submitNow(this);"/>
                                            </ice:panelGrid>
                                             <ice:panelGroup
                                                visible="#{o:size(attributesBean.availableViewAttributes) == 0}">
                                                <ice:outputText
                                                    value="No user attributes. Try widening your search."/>
                                            </ice:panelGroup>
                                            <ice:panelGroup
                                                scrollHeight="200px">
                                                <ice:panelSeries
                                                    value="#{attributesBean.availableViewAttributes}"
                                                    var="viewAttribute">
                                                    <ice:panelGroup
                                                        styleClass="draggable"
                                                        draggable="true"
                                                        dragMask="dragging,drag_cancel,hover_start,hover_end"
                                                        dragValue="#{viewAttribute}"
                                                        dragOptions="dragGhost">
                                                        <ice:panelGrid columns="2">
                                                            <ice:graphicImage
                                                                value="../image/device.png"/>
                                                            <ice:panelGroup>
                                                                <ice:outputText
                                                                    value="#{viewAttribute.title}"/>
                                                            </ice:panelGroup>
                                                        </ice:panelGrid>
                                                    </ice:panelGroup>
                                                </ice:panelSeries>
                                            </ice:panelGroup>
                                        </ui:define>
                                    </o:multipanel>
                                </ice:panelGroup>
                            </ice:panelGrid>
                        </div>
                    </ui:define>
                </o:box>
            </div>
        </ice:panelGroup>
    </ice:panelSeries>
</span>
