<?xml version='1.0' encoding='UTF-8'?>
<span
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:ice="http://www.icesoft.com/icefaces/component"
    xmlns:c="http://java.sun.com/jstl/core"
    xmlns:o="http://opensso.dev.java.net">

    <ui:include src="resources-url-add-popup.xhtml"/>
    <ui:include src="resources-url-add-exception-popup.xhtml"/>
    
    <div class="section-outer">
        <o:box>
            <ui:define name="body">
                <div class="section-inner">
                    <span class="section-head">
                        <span class="section-title">
                            <ice:outputText value="URL Resources"/>
                        </span>
                        <span class="section-links">
                            <ice:panelGrid
                                columns="3">
                                <o:clink
                                    type="add"
                                    handler="#{urlResourcesHandler}"
                                    listenerMethod="addListener"/>
                                <ice:outputText
                                    style="font-weight: bold"
                                    value="|"/>
                                <ice:panelGroup
                                    columns="4">
                                    <ice:graphicImage
                                        value="/admin/image/search.png"/>
                                    <ice:outputText
                                        style="font-weight: bold"
                                        value="Search"/>
                                    <ice:inputText
                                        styleClass="section-input"
                                        onkeyup="typeSubmit(this);"
                                        value="#{urlResourcesBean.searchFilter}"
                                        valueChangeListener="#{urlResourcesHandler.searchFilterChangedListener}">
                                        <f:attribute
                                            name="viewEntitlement"
                                            value="#{viewEntitlement}"/>
                                        <f:attribute
                                            name="availableResources"
                                            value="#{availableResources}"/>
                                    </ice:inputText>
                                </ice:panelGroup>
                            </ice:panelGrid>
                        </span>
                    </span>
                    <div class="clear"></div>
                    <ice:selectManyCheckbox
                        id="resource-select"
                        layout="spread"
                        partialSubmit="true"
                        value="#{viewEntitlement.resources}"
                        converter="urlResourceConverter">
                        <f:selectItems
                            value="#{policyCreateWizardBean.availableResourceItems}"/>
                    </ice:selectManyCheckbox>
                    <ice:panelGroup
                        scrollHeight="200px">
                        <ice:panelSeries
                            var="urlResource"
                            value="#{availableResources}">
                            <ice:panelGroup
                                styleClass="url-resource-outer"
                                visible="#{urlResource.visible}">
                                <o:box>
                                    <ui:define name="body">
                                        <ice:panelGrid
                                            columns="2"
                                            styleClass="url-resource"
                                            columnClasses="url-resource-tableCol1,url-resource-tableCol2">
                                            <ice:checkbox
                                                styleClass="url-resource-checkbox"
                                                for="resource-select"
                                                index="#{o:indexOf(availableResources,urlResource)}">
                                            </ice:checkbox>
                                            <ice:panelGrid
                                                columns="1">
                                                <ice:panelGroup
                                                    rendered="#{urlResource.exceptable}">
                                                    <o:clink
                                                        type="add"
                                                        linkLabel="Add Exception"
                                                        handler="#{urlResourcesHandler}"
                                                        listenerMethod="addExceptionListener">
                                                        <ui:define name="attributes">
                                                            <f:attribute
                                                                name="urlResource"
                                                                value="#{urlResource}"/>
                                                        </ui:define>
                                                    </o:clink>
                                                </ice:panelGroup>
                                            </ice:panelGrid>
                                        </ice:panelGrid>
                                    </ui:define>
                                </o:box>
                            </ice:panelGroup>
                        </ice:panelSeries>
                    </ice:panelGroup>
                </div>
            </ui:define>
        </o:box>
    </div>
    <div class="section-outer">
        <o:box>
            <ui:define name="body">
                <div class="section-inner">
                    <span class="section-head">
                        <span class="section-title">
                            <ice:outputText value="Exceptions"/>
                        </span>
                    </span>
                    <div class="clear"></div>
                    <ice:panelGroup
                        scrollHeight="100px">
                        <ice:panelSeries
                            var="urlResource"
                            value="#{viewEntitlement.exceptions}">
                            <ice:panelGroup
                                styleClass="url-resource-outer"
                                visible="#{urlResource.visible}">
                                <o:box>
                                    <ui:define name="body">
                                        <ice:panelGrid
                                            styleClass="url-resource"
                                            columnClasses="url-resource-tableCol1,url-resource-tableCol2"
                                            columns="2">
                                            <ice:outputText
                                                value="#{urlResource.name}"/>
                                            <ice:panelGrid
                                                columns="1">
                                                <o:clink
                                                    type="remove"
                                                    handler="#{urlResourcesHandler}"
                                                    listenerMethod="removeExceptionListener">
                                                    <ui:define name="attributes">
                                                        <f:attribute
                                                            name="urlResource"
                                                            value="#{urlResource}"/>
                                                        <f:attribute
                                                            name="viewEntitlement"
                                                            value="#{viewEntitlement}"/>
                                                    </ui:define>
                                                </o:clink>
                                            </ice:panelGrid>
                                        </ice:panelGrid>
                                    </ui:define>
                                </o:box>
                            </ice:panelGroup>
                        </ice:panelSeries>
                    </ice:panelGroup>
                </div>
            </ui:define>
        </o:box>
    </div>
</span>
