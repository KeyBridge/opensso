<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<!--
   The contents of this file are subject to the terms
   of the Common Development and Distribution License
   (the License). You may not use this file except in
   compliance with the License.
                                                                                                                                  
   You can obtain a copy of the License at
   https://opensso.dev.java.net/public/CDDLv1.0.html or
   opensso/legal/CDDLv1.0.txt
   See the License for the specific language governing
   permission and limitations under the License.
                                                                                                                                  
   When distributing Covered Code, include this CDDL
   Header Notice in each file and include the License file
   at opensso/legal/CDDLv1.0.txt.
   If applicable, add the following below the CDDL Header,
   with the fields enclosed by brackets [] replaced by
   your own identifying information:
   "Portions Copyrighted [year] [name of copyright owner]"

   $Id: index.html,v 1.2 2007-09-13 22:55:12 mallas Exp $

   Copyright 2007 Sun Microsystems Inc. All Rights Reserved
-->
  <title>Security Token Service Client Sample</title>
  <meta http-equiv="Content-Type"
 content="text/html; charset=iso-8859-1">
  <link rel="stylesheet" type="text/css"
 href="../com_sun_web_ui/css/css_ns6up.css">
</head>
<body class="DefBdy">
<div class="MstDiv">
<table class="MstTblTop" title="" border="0" cellpadding="0"
 cellspacing="0" width="100%">
  <tbody>
    <tr>
      <td nowrap="nowrap">&nbsp;</td>
      <td nowrap="nowrap">&nbsp;</td>
    </tr>
  </tbody>
</table>
<table class="MstTblBot" title="" border="0" cellpadding="0"
 cellspacing="0" width="100%">
  <tbody>
    <tr>
      <td class="MstTdTtl" width="99%">
      <div class="MstDivTtl"><img name="ProdName"
 src="../console/images/PrimaryProductName.png" alt=""></div>
      </td>
      <td class="MstTdLogo" width="1%"><img
 name="RMRealm.mhCommon.BrandLogo"
 src="../com_sun_web_ui/images/other/javalogo.gif" alt="Java(TM) Logo"
 border="0" height="55" width="31"></td>
    </tr>
  </tbody>
</table>
<table class="MstTblEnd" border="0" cellpadding="0" cellspacing="0"
 width="100%">
  <tbody>
    <tr>
      <td><img name="RMRealm.mhCommon.EndorserLogo"
 src="../com_sun_web_ui/images/masthead/masthead-sunname.gif"
 alt="Sun(TM) Microsystems, Inc." align="right" border="0" height="10"
 width="108"></td>
    </tr>
  </tbody>
</table>
</div>
<div class="SkpMedGry1"><a name="SkipAnchor2089" id="SkipAnchor2089"></a></div>
<div class="SkpMedGry1"><a href="#SkipAnchor4928"><img
 src="../com_sun_web_ui/images/other/dot.gif"
 alt="Jump Over Tab Navigation Area. Current Selection is: Access Control"
 border="0" height="1" width="1"></a></div>
<table border="0" cellpadding="10" cellspacing="0" width="100%">
  <tbody>
    <tr>
      <td>
      <p>&nbsp;</p>
      <a href="../index.html">Client Samples Main Page</a>
      <p>&nbsp;</p>
      <h3>Introduction</h3>
      <p> This sample demonstrates the usage of Security Token Service
Client API for obtaining security tokens from a Security Token Service
hosted on Federation Access Manager. <br>
There are three parties involved in this sample: <br>
* Web Services Client (WSC) <br>
* Web Services Provider (WSP) <br>
* Security Token Service (STS)<br>
      </p>
      <p>The security token service issues security tokens for web
services clients so that web services clients could present it to the
web services providers for authentication purposes.The Federation
Access Manager Security Token Service currently issues
SAML1 security tokens and SAML2 security tokens for web services
clients. In order to generate SAML Tokens, web services client must
need to authenticate against
using it's X509 Certificate. <br>
      </p>
      <h3>Setup</h3>
This sample needs configuration of Security Token Service hosted on
Federation Access Manager , Security Token Service Client
Configuration, Web Services Client Configuration and Web Services
Provider Configuration. The web services security in
Federation Access Manager requires a JKS KeyStore. Creating a JKS
Keystore is describes in SAML samples and this samples assumes that you
have created the keystore and
the corresponding keypass and storepass files. You could use different
private keys for STS, WSC and WSP.<br>
      <br>
      <span style="font-weight: bold;">Before you setup STS, deploy the
stockquote web service client and stock quote web service provider as
mentioned in the README file of web services agent samples. This is
must before running this sample. Also follow the steps in README to
configure Glassfish for web services security using FAM JSR196 agents.</span><br
 style="font-weight: bold;">
      <br>
STS Setup:<br>
      <br>
Currently the FAM STS requires&nbsp; keystore to be configured in WSDL
also. By default, the fam.war does not have this configured as it would
not know the location of keystore. So,this would require re-deploy of
the FAM war on glassfish if you have
already deployed FAM. <br>
      <br>
&nbsp;&nbsp; 1.&nbsp; Unwar the fam.war <br>
&nbsp;&nbsp; 2.&nbsp; Open the famsts.wsdl from WEB-INF/wsdl directory<br>
&nbsp;&nbsp; 3.&nbsp; Check for TrustStore and KeyStore XML elements,
uncomment these elements.<br>
&nbsp;&nbsp; 4.&nbsp; Modify the kestore location, passwords, and
recreate the war file using jar cvf&nbsp; fam.war<br>
&nbsp;&nbsp; 5.&nbsp; Redeploy the war file and make sure that
FAM&nbsp; STS WSDL is accessible.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
http://&lt;host&gt;:&lt;port&gt;/fam/sts?wsdl<br>
      <br>
&nbsp;STS Client setp:<br>
      <br>
&nbsp;&nbsp;&nbsp;&nbsp; 1. Login into Administrative Console using
amadmin<br>
&nbsp;&nbsp;&nbsp;&nbsp; 2. Click on default realm "opensso" and
Subjects tab<br>
&nbsp;&nbsp;&nbsp;&nbsp; 3. Click on "Agent" tab<br>
&nbsp;&nbsp;&nbsp;&nbsp; 4. Click "New"<br>
&nbsp;&nbsp;&nbsp;&nbsp; 5. Enter "SecurityTokenService" as the ID,
Select "Web Services Security Client" as the Agent type, enter any
password for the agent and click "OK"<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; This will
redirect back to the Agent(s) page.<br>
&nbsp;&nbsp;&nbsp;&nbsp; 6. Click on the created "SecurityTokenService"
agent.<br>
&nbsp;&nbsp;&nbsp;&nbsp; 7. Select "SecurityMechanism" as "X509Token",
enable "isRequestSignEnabled", Enter "Web Service Endpoint" as your
planned WSP point.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; For e.g. if you use
stock quote service, the end point would be
"http://&lt;host&gt;:&lt;port&gt;/StockService/StockService"<br>
&nbsp;&nbsp;&nbsp;&nbsp; 8. Use rest of&nbsp; the configuration as it
is and save the configuration.<br>
      <br>
StockService Web Service Client:&nbsp; Create a web services client
configuration Stock Service. The default WSC configuration can not be
used.<br>
&nbsp; <br>
&nbsp;&nbsp;&nbsp;&nbsp; 1. Login into Administrative Console using
amadmin<br>
&nbsp;&nbsp;&nbsp;&nbsp; 2. Click on default realm "opensso" and
Subjects tab<br>
&nbsp;&nbsp;&nbsp;&nbsp; 3. Click on "Agent" tab<br>
&nbsp;&nbsp;&nbsp;&nbsp; 4. Click "New"<br>
&nbsp;&nbsp;&nbsp;&nbsp; 5. Enter "StockService" as the ID, Select "Web
Services
Security Client" as the Agent type, enter any password for the agent
and click "OK"<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; This will
redirect back to the Agent(s) page.<br>
&nbsp;&nbsp;&nbsp;&nbsp; 6. Click on the created "StockService" agent.<br>
&nbsp;&nbsp;&nbsp;&nbsp; 7. Select "SecurityMechanism" as
"STSSecurity", enable
"isRequestSignEnabled".<br>
&nbsp;&nbsp;&nbsp;&nbsp; 8. Use rest of&nbsp; the configuration as it
is and save the configuration.<br>
      <br>
      <br>
Stock Service Web Service Provider:&nbsp;&nbsp; You can use default WSP
configuration or you can create StockServiceWSP.<br>
      <br>
&nbsp;&nbsp;&nbsp;&nbsp; 1. Login into Administrative Console using
amadmin<br>
&nbsp;&nbsp;&nbsp;&nbsp; 2. Click on default realm "opensso" and
Subjects tab<br>
&nbsp;&nbsp;&nbsp;&nbsp; 3. Click on "Agent" tab<br>
&nbsp;&nbsp;&nbsp;&nbsp; 4. Click "New"<br>
&nbsp;&nbsp;&nbsp;&nbsp; 5. Enter "StockServiceWSP" as the ID, Select
"Web Services
Security Provider" as the Agent type, enter any password for the agent
and click "OK"<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; This will
redirect back to the Agent(s) page.<br>
&nbsp;&nbsp;&nbsp;&nbsp; 6. Click on the created "StockServiceWSP"
agent.<br>
&nbsp;&nbsp;&nbsp;&nbsp; 7. Enabled all SecurityMechanisms , enable
"isRequestSignEnabled".<br>
&nbsp;&nbsp;&nbsp;&nbsp; 8. Use rest of&nbsp; the configuration as it
is and save the configuration.<br>
      <br>
      <h3>How to Run:</h3>
1. Deploy the fam client samples in glassfish and make sure that you
have configured as in readme index.html file<br>
2. Access http://&lt;host&gt;:&lt;port&gt;/fam-client/sts/sts-client.jsp<br>
3. Enter web service name as "StockService" and click "GetToken"<br>
4. If successful, this will display SAML Assertion obtained from FAM
Security Token Service.<br>
      <br>
      </td>
    </tr>
  </tbody>
</table>
<br>
</body>
</html>
