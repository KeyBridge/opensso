<?xml version="1.0" encoding="ISO-8859-1"?>
                                                                                
<!DOCTYPE Policies
    PUBLIC "-//iPlanet//Sun Java System Access Manager 2005Q4 Admin CLI DTD//EN"    "jar://com/sun/identity/policy/policyAdmin.dtd">
                                                                                
<Policies>
<Policy name="dc=opensso^dc=java^dc=net^^RealmAdmin" referralPolicy="false" active="true" >
<Rule name="delegation-rule1">
<ServiceName name="sunAMDelegationService" />
<ResourceName name="sms://*dc=opensso,dc=java,dc=net/*" />
<AttributeValuePair>
<Attribute name="MODIFY" />
<Value>allow</Value>
</AttributeValuePair>
<AttributeValuePair>
<Attribute name="DELEGATE" />
<Value>allow</Value>
</AttributeValuePair>
<AttributeValuePair>
<Attribute name="READ" />
<Value>allow</Value>
</AttributeValuePair>
</Rule>
<Subjects name="Subjects" description="">
<Subject name="delegation-subject" type="AMIdentitySubject" includeType="inclusive">
<AttributeValuePair>
<Attribute name="Values"/>
<Value>id=Top-level Admin Role,ou=role,dc=opensso,dc=java,dc=net,amsdkdn=cn=Top-level Admin Role,dc=opensso,dc=java,dc=net</Value>
</AttributeValuePair>
</Subject>
</Subjects>
</Policy>
<Policy name="dc=opensso^dc=java^dc=net^^PolicyAdmin" referralPolicy="false" active="true" >
<Rule name="delegation-rule1">
<ServiceName name="sunAMDelegationService" />
<ResourceName name="sms://*dc=opensso,dc=java,dc=net/iPlanetAMPolicy*Service/*" />
<AttributeValuePair>
<Attribute name="MODIFY" />
<Value>allow</Value>
</AttributeValuePair>
<AttributeValuePair>
<Attribute name="DELEGATE" />
<Value>allow</Value>
</AttributeValuePair>
<AttributeValuePair>
<Attribute name="READ" />
<Value>allow</Value>
</AttributeValuePair>
</Rule>
<Rule name="delegation-rule2">
<ServiceName name="sunAMDelegationService" />
<ResourceName name="sms://*dc=opensso,dc=java,dc=net/sunAMRealmService/*" />
<AttributeValuePair>
<Attribute name="READ" />
<Value>allow</Value>
</AttributeValuePair>
</Rule>
<Rule name="delegation-rule3">
<ServiceName name="sunAMDelegationService" />
<ResourceName name="sms://*dc=opensso,dc=java,dc=net/sunIdentityRepositoryService/*" />
<AttributeValuePair>
<Attribute name="READ" />
<Value>allow</Value>
</AttributeValuePair>
</Rule>
<Subjects name="Subjects" description="">
<Subject name="delegation-subject" type="AMIdentitySubject" includeType="inclusive">
<AttributeValuePair>
<Attribute name="Values"/>
<Value>id=Top-level Policy Admin Role,ou=role,dc=opensso,dc=java,dc=net,amsdkdn=cn=Top-level Policy Admin Role,dc=opensso,dc=java,dc=net</Value>
</AttributeValuePair>
</Subject>
</Subjects>
</Policy>

<!-- Delegation policy for all authenticated users to use DAI,admin console,IdRepo Service -->
<Policy name="AllUserReadableServices" referralPolicy="false" active="true" >
    <Rule name="delegation-rule1">
        <ServiceName name="sunAMDelegationService" />
        <ResourceName name="sms://dc=opensso,dc=java,dc=net/sunIdentityRepositoryService/1.0/globalConfig/*" />
        <AttributeValuePair>
            <Attribute name="READ" />
            <Value>allow</Value>
        </AttributeValuePair>
    </Rule>
    <Rule name="delegation-rule2">
        <ServiceName name="sunAMDelegationService" />
        <ResourceName name="sms://dc=opensso,dc=java,dc=net/DAI/1.0/globalConfig/*" />
        <AttributeValuePair>
            <Attribute name="READ" />
            <Value>allow</Value>
        </AttributeValuePair>
    </Rule>
    <Rule name="delegation-rule3">
        <ServiceName name="sunAMDelegationService" />
        <ResourceName name="sms://dc=opensso,dc=java,dc=net/iPlanetAMAdminConsoleService/1.0/globalConfig/*" />
        <AttributeValuePair>
            <Attribute name="READ" />
            <Value>allow</Value>
        </AttributeValuePair>
    </Rule>
    <Subjects name="Subjects" description="">
        <Subject name="delegation-subject" type="AuthenticatedUsers" includeType="inclusive">
        </Subject>
    </Subjects>
</Policy>

<!-- Delegation policy for users to read their attributes -->
<Policy name="SelfReadAttributes" referralPolicy="false" active="true" >
    <Rule name="user-read-rule">
        <ServiceName name="sunAMDelegationService" />
        <ResourceName name="sms://*dc=opensso,dc=java,dc=net/sunIdentityRepositoryService/1.0/application/*" />
        <AttributeValuePair>
            <Attribute name="READ" />
            <Value>allow</Value>
        </AttributeValuePair>
    </Rule>
    <Subjects name="Subjects" description="">
        <Subject name="delegation-subject" type="AuthenticatedUsers" includeType="inclusive">
        </Subject>
    </Subjects>
    <Conditions name="AttrCondition" description="">
        <Condition name="condition" type="UserSelfCheckCondition">
            <AttributeValuePair>
                <Attribute name="attributes"/>
                <Value>*</Value>
            </AttributeValuePair>
        </Condition>
    </Conditions>
</Policy>

<!-- Delegation policy for users to write their attributes -->
<Policy name="SelfWriteAttributes" referralPolicy="false" active="true" >
    <Rule name="user-read-rule">
        <ServiceName name="sunAMDelegationService" />
        <ResourceName name="sms://*dc=opensso,dc=java,dc=net/sunIdentityRepositoryService/1.0/application/*" />
        <AttributeValuePair>
            <Attribute name="MODIFY" />
            <Value>allow</Value>
        </AttributeValuePair>
    </Rule>
    <Subjects name="Subjects" description="">
        <Subject name="delegation-subject" type="AuthenticatedUsers" includeType="inclusive">
        </Subject>
    </Subjects>
    <Conditions name="AttrCondition" description="">
        <Condition name="condition" type="UserSelfCheckCondition">
            <AttributeValuePair>
                <Attribute name="attributes"/>
                <Value>givenname</Value>
                <Value>sn</Value>
                <Value>cn</Value>
                <Value>userpassword</Value>
                <Value>mail</Value>
                <Value>telephonenumber</Value>
                <Value>postaladdress</Value>
                <Value>preferredlocale</Value>
                <Value>iplanet-am-user-password-reset-options</Value>
                <Value>iplanet-am-user-password-reset-question-answer</Value>
                <Value>iplanet-am-user-password-reset-force-reset</Value>
                <Value>description</Value>
                <Value>sunIdentityServerDeviceKeyValue</Value>
                <Value>sunIdentityServerDeviceStatus</Value>
            </AttributeValuePair>
        </Condition>
    </Conditions>
</Policy>
</Policies>
