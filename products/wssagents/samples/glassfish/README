<!--
   The contents of this file are subject to the terms
   of the Common Development and Distribution License
   (the License). You may not use this file except in
   compliance with the License.

   You can obtain a copy of the License at
   https://opensso.dev.java.net/public/CDDLv1.0.html or
   opensso/legal/CDDLv1.0.txt
   See the License for the specific language governing
   permission and limitations under the License.

   When distributing Covered Code, include this CDDL
   Header Notice in each file and include the License file
   at opensso/legal/CDDLv1.0.txt.
   If applicable, add the following below the CDDL Header,
   with the fields enclosed by brackets [] replaced by
   your own identifying information:
   "Portions Copyrighted [year] [name of copyright owner]"

   $Id: README,v 1.6 2008-06-15 07:24:31 mrudul_uchil Exp $

   Copyright 2008 Sun Microsystems Inc. All Rights Reserved
-->

README
=======

This README explains the steps for web services security using glassfish
security agents. 

Before you begin:
=================

The web services security for JAX-WS based web services is achieved using
JSR196 providers. Before you begin, follow the README.glassfish from the 
install directory of the zip file. 

General Description: 
====================

The samples provided here are JAX-WS based web service, a web services
client and a standalone client. 
The sample demonstrates a simple stock quote service where given
a stock ticker symbol it obtains stock data. The secure communication
between stock quote web services client is achieved using Federation
Access Manager web services security agents. The web services security
agents profile configuation is stored in backend repository information
like regular FAM agents.  

Deployment of samples:
======================

To configure for web services security, essentially there are two steps
besides configuring the providers as mentioned above (Before you begin
section).
 

I. Deploy the samples

   The samples here are provided with convenient "ant" build script to
   build and deploy the samples. This sample comes with two directories
   StockQuoteClient and StockService which are for the web services client
   and web service respectively. Also, it has a file name called as 
   glassfish.properties. 

   1. Open glassfish.properties and set the correct path for glassfish.home

   2. Make sure that JAVA_HOME is set to JDK1.5 installation and similarly
      make sure java and javac are in the PATH you are executing it.

   3. Use "ant" from <ApplicationServer-install>/lib/ant/bin/ant

   4. cd StockQuoteClient and run "ant -f build.xml". This will build
      and deploy the StockQuoteClient onto glassfish container.

   5. cd StockService and run "ant -f build.xml". This will build
      and deploy the StockService onto glassfish container.


II. Configure the web services client for "StockService".

1.  Login into the Federated Access Manager Console with user amadmin and <amadmin password>

    famserver_protocol://famserver_host:famserver_port/famserver_deploy_uri

    Note: If you have logged in as any other user, click Logout on the console page and Login again and make sure that you access the Federated Access Manager Console.

    Create agent profiles for "StockService" WSC :

      Go to Access Control → Default realm → Agents →

        a) Create "WSC" profile for "StockService"
        Select Web Service Client → under Agent, click "new" → enter name as "StockService" and other required fields → Save.
        Click on above saved profile to edit → Select required Security Mechanism, "Preserve Security Headers in Message" as
        true (checked) and "Is Request Signed" as true (checked).
        Save changes.
        Note : If the required or selected Security Mechanism is “STSSecurity”, then 
        select STS Configuration as “SecurityTokenService" and Web Service End Point as “default”. 

        b) Create "WSP" profile (if not already created)
        Select Web Service Provider → under Agent, click "new" → enter name as "wsp" and other required fields → Save.
        Click on above saved profile to edit → Select all Security Mechanisms.
        Select Web Service End Point as “default” and "Is Request Signature Verified" as true (checked).
        Save changes.

2.  Logout of Federated Access Manager Administration console.

III. Run the samples

  a) Web Service Client sample :
    1. Access the stock quote client page.

       http://<host>:<port>/StockQuoteClient/index.jsp

    2. Enter "JAVA" as stock ticker symbol and click "Get Quote".

    3. If successful, this will display the stock values.

  b) Standalone Client sample :
    1. cd StandAloneStockClient directory

    2. run "ant -f build.xml". 
    This will build and run the Standalone client sample.

